@*回写目标2 适配移动端 查看详细页面 - 列表点击详细打开此页面*@
@*Think9企业级开发工具 http://yourslc.top Create:admin 2024-09-24 13:11:04 列表-此文件放置于Views/HXMB2 /中*@

@using Think9.Models;
@{ ViewBag.Title = "MobileDetail";
    Layout = "~/Areas/Shared/_LayuiMobileForm.cshtml";}

<style type="text/css">
    .layui-table-cell {
        height: auto;
        line-height: 35px;
    }
    .layui-table{
        border: 2px solid #fff; /* 不加手机右侧总有两道线 */
    }
</style>

<form class="layui-form layui-form-pane" lay-filter="formUser">
<input style="display:none" id="_listid" value="@ViewBag.ListId">
<input style="display:none" id="_fwid" value="bi_HXMB2">
<input style="display:none" id="_userid" value="@ViewBag.UserId">
<input style="display:none" id="_isMobile" value="y">@*y为移动端*@
<input style="display:none" id="_type" value="detail">
<table class="layui-hide" id="tableId" lay-filter="tableFilter"></table>

</form>
<script>
	layui.use(["form", "exLayer", "element", "exUtils",  "table"], function () {
		let form = layui.form;
		let layer = layui.layer;
		let table = layui.table;
		let exLayer = layui.exLayer;
		let exUtils = layui.exUtils;
		let element = layui.element;

		let $ = layui.$;

		form.render();//更新全部表单数据

        //渲染表格，url数据接口参数；cols设置显示字段...
        let ThisTable = table.render({
            elem: "#tableId",
            url: "/_TB/GetMobileDetail" + "?fwid=" + $("#_fwid").val() + "&listid=" + $("#_listid").val() + "&isOriginal=y",
            method: "GET",
            defaultToolbar: [{ title: '关闭', layEvent: 'close', icon: 'layui-icon-close' }],
            toolbar: "#toolbarTpl",
            cols: [[
                { templet: "#mobile_list" }
            ]],
            done: function (res, curr, count) {
                if (count == -1) {
                    //layer.msg(res.msg, { icon: 5, time: 20000, btn: ['关闭'] });//显示错误
                }
                $("#pdf").attr("href", "/_TB/GetDetail?listid=" + $('#_listid').val() + "&type=pdf&fwid=bi_HXMB2&isOriginal=y");
				$("#excel").attr("href", "/_TB/GetDetail?listid=" + $('#_listid').val() + "&type=excel&fwid=bi_HXMB2&isOriginal=y");
				$("#doc").attr("href", "/_TB/GetDetail?listid=" + $('#_listid').val() + "&type=doc&fwid=bi_HXMB2&isOriginal=y");
				$("#att").attr("href", "/Com/FileManage/AttList?listid=" + $('#_listid').val() + "&fwid=bi_HXMB2" + "&isOriginal=y&userid=" + $('#_userid').val());
            }
        });

        //toolbar监听事件(处理table顶部按钮)
        table.on("toolbar(tableFilter)", function (obj) {
            switch (obj.event) {
                case "close":
                    parent.layer.close(parent.layer.getFrameIndex(window.name));
                    break;
            }
        });
	});
</script>
<!-- 行工具栏模板 -->
<script type='text/html' id='mobile_list'>
	<div class='layui-tab-content'>
		<div class='layui-table-cell' style='margin-left:-25px;margin-right:-25px;overflow:visible;text-overflow:inherit;white-space:normal;'>编码： {{d.inCoding ==  null ? '' : d.inCoding}}</div>
		<div class='layui-table-cell' style='margin-left:-25px;margin-right:-25px;overflow:visible;text-overflow:inherit;white-space:normal;'>名称： {{d.inName ==  null ? '' : d.inName}}</div>
		<div class='layui-table-cell' style='margin-left:-25px;margin-right:-25px;overflow:visible;text-overflow:inherit;white-space:normal;'>上报人： {{d.inReportPerson ==  null ? '' : d.inReportPerson}}</div>
		<div class='layui-table-cell' style='margin-left:-25px;margin-right:-25px;overflow:visible;text-overflow:inherit;white-space:normal;'>上报日期： {{d.inReportDate ==  null ? '' : showDate(d.inReportDate)}}</div>
		<div class='layui-table-cell' style='margin-left:-25px;margin-right:-25px;overflow:visible;text-overflow:inherit;white-space:normal;'>小数： {{d.inDecimal ==  null ? '' : d.inDecimal}}</div>
		<div class='layui-table-cell' style='margin-left:-25px;margin-right:-25px;overflow:visible;text-overflow:inherit;white-space:normal;'>备注： {{d.inRemarks ==  null ? '' : d.inRemarks}}</div>
	</div>
</script>
<!-- 头工具栏模板 -->
<script type="text/html" id="toolbarTpl">
   <div class="layui-btn-container">
       <a href="" target="_blank" id="pdf" class="layui-btn layui-btn-primary layui-btn-sm"><i class="fa fa-file-pdf-o"></i></a>&nbsp;
       <a href="" target="_blank" id="excel" class="layui-btn layui-btn-primary layui-btn-sm"><i class="fa fa-file-excel-o"></i></a>&nbsp;
        <a href="" target="_blank" id="doc" class="layui-btn layui-btn-primary layui-btn-sm"><i class="fa fa-file-word-o"></i></a>&nbsp;
        <a href="" target="_blank" id="att" class="layui-btn layui-btn-primary layui-btn-sm"><i class="fa fa-file-o"></i></a>
  </div>
</script>

<!-- 图片显示 -->
<script>
    function PopUpImg(id) {
        showImg(id);//在global.js中定义
    }
</script>